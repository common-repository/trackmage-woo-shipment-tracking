"use strict";!function(o,a){var r={main:trackmageAdmin,statusManager:trackmageAdminStatusManager};o(a).on("click","#statusManager .row-actions .edit-status",function(a){var t=o(this).closest("tbody"),n=o(this).closest("tr"),i=o(n).data("status-is-custom"),s=o(n).data("status-name"),u=o(n).data("status-slug"),e=o(n).data("status-slug"),l=o(n).data("status-alias"),c=(o(t).children("tr.hidden").removeClass("hidden"),o(n).addClass("hidden"),o(t).children(".adjust-odd-even").remove(),o(t).children(".inline-edit-row").remove(),o('\n          <tr class="hidden adjust-odd-even"></tr>\n          <tr id="edit-'.concat(e,'" class="inline-edit-row">\n            <td colspan="4" class="colspanchange">\n              <fieldset class="inline-edit-col-left">\n                <legend class="inline-edit-legend">').concat(r.statusManager.i18n.edit,'</legend>\n                <div class="inline-edit-col">\n                  <label>\n                    <span class="title">').concat(r.statusManager.i18n.name,'</span>\n                    <span class="input-text-wrap"><input type="text" name="status_name" value="" /></span>\n                  </label>\n                  <label>\n                    <span class="title">').concat(r.statusManager.i18n.slug,'</span>\n                    <span class="input-text-wrap"><input type="text" name="status_slug" value="" /></span>\n                  </label>\n                  <label>\n                    <span class="title">').concat(r.statusManager.i18n.alias,'</span>\n                    <select name="status_alias">\n                      <option value="" selected="selected">').concat(r.main.i18n.noSelect,"</option>\n                      ").concat(Object.keys(r.statusManager.aliases).map(function(a){return'<option value="'.concat(a,'">').concat(r.statusManager.aliases[a],"</option>")}).join(""),'\n                    </select>\n                  </label>\n                </div>\n              </fieldset>\n              <div class="submit inline-edit-save">\n                <button type="button" class="button cancel alignleft">').concat(r.statusManager.i18n.cancel,'</button>\n                <button type="button" class="button button-primary save alignright">').concat(r.statusManager.i18n.update,'</button>\n                <span class="spinner"></span>\n                <br class="clear">\n              </div>\n            </div>\n            </td>\n          </tr>\n        ')));o(c).insertAfter(n),o.each(r.statusManager.used_aliases,function(a,t){l!==t?o(c).find("select[name=status_alias] option[value="+t+"]").eq(0).hide():(o(c).find("select[name=status_alias] option").removeAttr("selected"),o(c).find("select[name=status_alias] option[value="+t+"]").attr("selected","selected"))}),o(c).find('[name="status_name"]').val(s),o(c).find('[name="status_slug"]').val(e),o(c).find('[name="status_alias"]').val(l),1!==i&&o(c).find('[name="status_slug"], [name="status_name"]').prop("disabled",!0),o(c).find("button.cancel").on("click",function(){o(c).remove(),o(n).removeClass("hidden")}),o(c).find("button.save").on("click",function(){var a=o(this),t=o(c).find('[name="status_name"]'),s=o(c).find('[name="status_slug"]'),e=o(c).find('[name="status_alias"]'),t={action:"trackmage_update_status",security:r.statusManager.nonces.updateStatus,name:o(t).val(),currentSlug:u,slug:o(s).val(),alias:o(e).val(),isCustom:i};o.ajax({url:r.main.urls.ajax,method:"post",data:t,beforeSend:function(){trackmageToggleSpinner(a,"activate"),trackmageToggleFormElement(a,"disable")},success:function(a){a.success?(r.statusManager.used_aliases=a.data.result.used,e=a.data.result.name,t=a.data.result.slug,s=a.data.result.alias,o(n).find("[data-update-status-name]").html(e),o(n).data("status-name",e),o(n).find("[data-update-status-slug]").html(t),o(n).data("status-slug",t),o(n).find("[data-update-status-alias]").html(r.statusManager.aliases[s]||""),o(n).data("status-alias",s),o(".add-status select[name=status_alias] option").show(),o.each(r.statusManager.used_aliases,function(a,t){o(".add-status select[name=status_alias] option[value="+t+"]").hide()}),o(c).remove(),o(n).removeClass("hidden").effect("highlight",{color:"#c3f3d7"},500)):o(c).removeClass("hidden").effect("highlight",{color:"#ffe0e3"},500);var t,s,e={title:a.success?r.main.i18n.success:r.main.i18n.failure,message:a.data.message||(a.success?"":r.main.i18n.unknownError),type:a.success?"success":"failure"};trackmageAlert(e.title,e.message,e.type,!0)},error:function(){trackmageAlert(r.main.i18n.failure,r.main.i18n.unknownError,"failure",!0)},complete:function(){trackmageToggleSpinner(a,"deactivate"),trackmageToggleFormElement(a,"enable")}})})}),o("#statusManager .add-status #addStatus").on("click",function(a){var t=o(this),s=o('#statusManager .add-status [name="status_name"]'),e=o('#statusManager .add-status [name="status_slug"]'),n=o('#statusManager .add-status [name="status_alias"]'),s={action:"trackmage_add_status",security:r.statusManager.nonces.addStatus,name:o(s).val(),slug:o(e).val(),alias:o(n).val()};o.ajax({url:r.main.urls.ajax,method:"post",data:s,beforeSend:function(){trackmageToggleSpinner(t,"activate"),trackmageToggleFormElement(t,"disable")},success:function(a){a.success&&(t=a.data.result.name,n=a.data.result.slug,s=a.data.result.alias,e=o("#statusManager tbody"),t='\n            <tr id="status-'.concat(n,'" data-status-name="').concat(t,'" data-status-slug="').concat(n,'" data-status-alias="').concat(s,'" data-status-is-custom="1">\n              <td>\n                <span data-update-status-name>').concat(t,'</span>\n                <div class="row-actions">\n                  <span class="inline"><button type="button" class="button-link edit-status">').concat(r.statusManager.i18n.edit,'</button></span>\n                  <span class="inline delete"> | <button type="button" class="button-link delete-status">').concat(r.statusManager.i18n.delete,"</button></span>\n                </div>\n              </td>\n              <td><span data-update-status-slug>").concat(n,'</span></td>\n              <td colspan="2"><span data-update-status-alias>').concat(r.statusManager.aliases.hasOwnProperty(s)?r.statusManager.aliases[s]:"","</span></td>\n            </tr>\n          "),o(t).appendTo(e).effect("highlight",{color:"#c3f3d7"},500),r.statusManager.used_aliases=a.data.result.used,o(".add-status input, .add-status select").val(""),o(".add-status select.status_alias option").show(),o.each(r.statusManager.used_aliases,function(a,t){o(".add-status select[name=status_alias] option[value="+t+"]").hide()}));var t,s,e,n={title:a.success?r.main.i18n.success:r.main.i18n.failure,message:a.data.message||(a.success?"":r.main.i18n.unknownError),type:a.success?"success":"failure"};trackmageAlert(n.title,n.message,n.type,!0)},error:function(){trackmageAlert(r.main.i18n.failure,r.main.i18n.unknownError,"failure",!0)},complete:function(){trackmageToggleSpinner(t,"deactivate"),trackmageToggleFormElement(t,"enable")}})}),o(a).on("click","#statusManager .row-actions .delete-status",function(a){var t=o(this).closest("tr"),s=o(t).data("status-slug"),e=null,n=o('#statusManager tr[id*="status-wc"]').toArray().filter(function(a){return o(a).data("status-slug")!==s}).map(function(a){return'<option value="'+o(a).data("status-slug")+'">'+o(a).data("status-slug")+"</option>"}),n=o('<div><p>Choose status to migrate orders to:<p><select required id="status_to_migrate">'+n.join()+"</select></div>");trackmageConfirmDialog(n,function(){return e=o("#status_to_migrate").val(),!0},r.statusManager.i18n.confirmDeleteStatus,r.statusManager.i18n.delete).then(function(a){if("yes"!==a)return!1;a={action:"trackmage_delete_status",security:r.statusManager.nonces.deleteStatus,slug:s,statusToMigrate:e};o.ajax({url:r.main.urls.ajax,method:"post",data:a,beforeSend:function(){},success:function(a){a.success&&(o(t).effect("highlight",{color:"#ffe0e3"},500),setTimeout(function(){o(t).remove()},500),r.statusManager.used_aliases=a.data.result.used,o(".add-status select[name=status_alias] option").show(),o.each(r.statusManager.used_aliases,function(a,t){o(".add-status select[name=status_alias] option[value="+t+"]").hide()}));a={title:a.success?r.main.i18n.success:r.main.i18n.failure,message:a.data.message||(a.success?"":r.main.i18n.unknownError),type:a.success?"success":"failure"};trackmageAlert(a.title,a.message,a.type,!0)},error:function(){trackmageAlert(r.main.i18n.failure,r.main.i18n.unknownError,"failure",!0)}})})})}(jQuery,(window,document));